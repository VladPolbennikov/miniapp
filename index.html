<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Mini App</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <div class="container">
    <header class="app-header">
      <img src="logo.jpg" alt="Bot logo" class="app-logo" />
      <div class="app-header-text">
        <h1 class="app-title">Pamela English Tutor</h1>
        <p class="app-subtitle">–ì–ª–∞–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –º–µ–Ω—é –±–æ—Ç–∞</p>
      </div>
    </header>

    <main class="actions">
      <section class="action">
        <button class="btn btn-primary" type="button" id="btn-stats" aria-label="–ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞">
          <span class="btn-icon">üìä</span>
          <span class="btn-text">–ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è</span>
        </button>
      </section>

      <section class="action">
        <button class="btn btn-neutral" type="button" id="btn-speed" aria-label="–°–∫–æ—Ä–æ—Å—Ç—å —Ä–µ—á–∏">
          <span class="btn-icon">‚è±Ô∏è</span>
          <span class="btn-text">–°–∫–æ—Ä–æ—Å—Ç—å —Ä–µ—á–∏ –±–æ—Ç–∞</span>
        </button>
      </section>

      <section class="action">
        <button class="btn btn-neutral" type="button" id="btn-voice" aria-label="–í—ã–±–æ—Ä –≥–æ–ª–æ—Å–∞">
          <span class="btn-icon">üéôÔ∏è</span>
          <span class="btn-text">–ò–∑–º–µ–Ω–∏—Ç—å –æ–∑–≤—É—á–∫—É –≥–æ–ª–æ—Å–∞</span>
        </button>
      </section>

      <section class="action">
        <button class="btn btn-premium" type="button" id="btn-premium" aria-label="–ü—Ä–µ–º–∏—É–º">
          <span class="btn-icon">‚≠ê</span>
          <span class="btn-text">–ö—É–ø–∏—Ç—å –ø—Ä–µ–º–∏—É–º –ø–æ–¥–ø–∏—Å–∫—É</span>
        </button>
        <div class="hint">–ë–æ–ª—å—à–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –ø–æ–¥–ø–∏—Å–∫–æ–π</div>
      </section>

      <section class="action">
        <button class="btn btn-neutral" type="button" id="btn-support" aria-label="–ü–æ–¥–¥–µ—Ä–∂–∫–∞">
          <span class="btn-icon">üí¨</span>
          <span class="btn-text">–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</span>
        </button>
      </section>
    </main>
  </div>

  <script>
      const tg = window.Telegram.WebApp;
      tg.ready();

      // HTTP —ç–Ω–¥–ø–æ–∏–Ω—Ç –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ (–∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ)
      const ENDPOINT = "https://pamelaenglishbot.ru/webapp";

      // –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–º–∞–Ω–¥ (–æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π sendPremium)
      async function sendCommand(command) {
        try {
          const queryId = tg?.initDataUnsafe?.query_id;
          if (!queryId) {
            console.log("query_id –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (Mini App –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –∏–∑ –º–µ–Ω—é/–≤–ª–æ–∂–µ–Ω–∏–π).");
            return;
          }

          const resp = await fetch(ENDPOINT, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ query_id: queryId, command: command }),
          });

          const data = await resp.json();
          if (!data.ok) {
            console.error("Server error:", data);
            return;
          }

          tg.close();
        } catch (e) {
          console.error(e);
        }
      }

      // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
      document.getElementById("btn-stats").addEventListener("click", () => sendCommand("stats"));
      document.getElementById("btn-speed").addEventListener("click", () => sendCommand("speed"));
      document.getElementById("btn-voice").addEventListener("click", () => sendCommand("voice"));
      document.getElementById("btn-premium").addEventListener("click", () => sendCommand("premium"));
      document.getElementById("btn-support").addEventListener("click", () => sendCommand("help"));
    </script>
</body>
</html>
