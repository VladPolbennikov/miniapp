<!-- index.html -->
<!doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
      html, body {
        margin: 0;
        padding: 0;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        background: var(--tg-theme-bg-color, #111);
        color: var(--tg-theme-text-color, #fff);
        height: 100%;
      }
      .wrap {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100%;
        padding: 24px;
      }
      button {
        font-size: 18px;
        padding: 14px 18px;
        border-radius: 12px;
        border: none;
        background: var(--tg-theme-button-color, #2ea6ff);
        color: var(--tg-theme-button-text-color, #fff);
        cursor: pointer;
      }
      button:active { transform: translateY(1px); }
    </style>
  </head>
  <body>
    <div class="wrap">
      <button id="btn-premium">üíé –ü—Ä–µ–º–∏—É–º</button>
    </div>

    <script>
      const tg = window.Telegram.WebApp;
      tg.ready();

      // –£–ö–ê–ñ–ò–¢–ï –ø—É–±–ª–∏—á–Ω—ã–π URL –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ (–≥–¥–µ –∑–∞–ø—É—â–µ–Ω aiohttp)
      // –ù–∞–ø—Ä–∏–º–µ—Ä: https://bot.example.com/webapp
      const ENDPOINT = "https://YOUR_BOT_HOST/webapp";

      async function sendPremium() {
        try {
          const queryId = tg?.initDataUnsafe?.query_id;
          if (!queryId) {
            alert("query_id –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (Mini App –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –∏–∑ –º–µ–Ω—é/–≤–ª–æ–∂–µ–Ω–∏–π).");
            return;
          }

          const resp = await fetch(ENDPOINT, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ query_id: queryId, command: "premium" }),
          });

          const data = await resp.json();
          if (!data.ok) {
            console.error("Server error:", data);
            alert("–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: " + (data.error || "unknown"));
            return;
          }

          // –ó–∞–∫—Ä—ã–≤–∞–µ–º Mini App –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
          tg.close();
        } catch (e) {
          console.error(e);
          alert("–û—à–∏–±–∫–∞: " + e.message);
        }
      }

      document
        .getElementById("btn-premium")
        .addEventListener("click", sendPremium);
    </script>
  </body>
</html>
